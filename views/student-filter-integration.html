<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Öğrenci Yılı Filtreleme Sistemi - Entegrasyon Örneği</title>
    
    <!-- CSS Dosyaları -->
    <link rel="stylesheet" href="css/dashboard.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Bootstrap (opsiyonel) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Mevcut Dashboard Yapısı -->
    <div class="container-fluid">
        <!-- Top Header Bar -->
        <div class="top-header-bar">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-md-4">
                        <div class="logo-section">
                            <img src="logo.png" alt="Logo" class="header-logo">
                            <div>
                                <div class="brand-name">Lab Yönetim Sistemi</div>
                                <div class="brand-subtitle">Öğrenci Yılı Filtreleme</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="header-stats">
                            <div class="header-stat-item">
                                <i class="fas fa-users"></i>
                                <div class="stat-number" id="totalStudentsCount">0</div>
                                <div class="stat-label">Toplam Öğrenci</div>
                            </div>
                            <div class="header-stat-item">
                                <i class="fas fa-desktop"></i>
                                <div class="stat-number" id="totalPCCount">0</div>
                                <div class="stat-label">PC Sayısı</div>
                            </div>
                            <div class="header-stat-item">
                                <i class="fas fa-check-circle"></i>
                                <div class="stat-number" id="availablePCCount">0</div>
                                <div class="stat-label">Boş PC</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="header-actions">
                            <button class="header-btn excel-btn" id="excelImportBtn">
                                <i class="fas fa-file-excel"></i>
                                <span class="btn-text">Excel İçe Aktar</span>
                            </button>
                            <button class="header-btn logout-btn" id="logoutBtn">
                                <i class="fas fa-sign-out-alt"></i>
                                <span class="btn-text">Çıkış</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="container-fluid">
                <!-- Lab Seçici Kartı -->
                <div class="lab-selector-card">
                    <div class="lab-selector-header">
                        <h3>
                            <i class="fas fa-desktop"></i>
                            Lab Seçimi
                        </h3>
                        <p>Filtreleme yapmak istediğiniz lab'ı seçin</p>
                    </div>
                    <div class="lab-selector-controls">
                        <div class="lab-select-wrapper">
                            <select class="lab-select" id="labSelect">
                                <option value="">Lab seçin...</option>
                                <option value="lab1">Lab 1 - Bilgisayar Laboratuvarı</option>
                                <option value="lab2">Lab 2 - Yazılım Laboratuvarı</option>
                                <option value="lab3">Lab 3 - Ağ Laboratuvarı</option>
                            </select>
                            <i class="fas fa-chevron-down select-arrow"></i>
                        </div>
                        <div class="control-buttons">
                            <button class="refresh-btn" id="refreshBtn">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button class="edit-pc-btn" id="editPcBtn">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="edit-max-students-btn" id="editMaxStudentsBtn">
                                <i class="fas fa-user-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Öğrenci Yılı Filtreleme Paneli -->
                <!-- Bu panel JavaScript tarafından dinamik olarak oluşturulacak -->
                <div id="studentFilterPanelContainer">
                    <!-- Filtreleme paneli buraya eklenecek -->
                </div>

                <!-- PC Kartları Container -->
                <div class="pc-cards-container">
                    <div class="pc-cards-header">
                        <h4>PC Durumları</h4>
                        <div class="pc-stats">
                            <div class="stat-item available">
                                <i class="fas fa-check-circle"></i>
                                <span>Boş</span>
                                <div class="stat-count" id="availableCount">0</div>
                            </div>
                            <div class="stat-item occupied">
                                <i class="fas fa-times-circle"></i>
                                <span>Dolu</span>
                                <div class="stat-count" id="occupiedCount">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="pc-cards-grid" id="pcCardsGrid">
                        <!-- PC kartları buraya eklenecek -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Dosyaları -->
    <script src="js/student-year-filter.js"></script>
    
    <!-- Örnek Kullanım Scripti -->
    <script>
        // Örnek veri ve entegrasyon
        document.addEventListener('DOMContentLoaded', function() {
            // Lab seçimi değiştiğinde
            document.getElementById('labSelect').addEventListener('change', function() {
                const selectedLab = this.value;
                if (selectedLab) {
                    // Örnek lab verisi
                    const labData = getLabData(selectedLab);
                    
                    // Lab değişikliği eventi gönder
                    const event = new CustomEvent('labChanged', {
                        detail: labData
                    });
                    document.dispatchEvent(event);
                    
                    // PC kartlarını oluştur
                    createPCCards(labData);
                }
            });

            // Örnek lab verisi
            function getLabData(labId) {
                const sampleData = {
                    'lab1': {
                        name: 'Lab 1 - Bilgisayar Laboratuvarı',
                        students: [
                            { name: 'Ahmet Yılmaz', year: 1, pcNumber: 'PC-01' },
                            { name: 'Ayşe Demir', year: 1, pcNumber: 'PC-02' },
                            { name: 'Mehmet Kaya', year: 2, pcNumber: 'PC-03' },
                            { name: 'Fatma Öz', year: 2, pcNumber: 'PC-04' },
                            { name: 'Ali Çelik', year: 3, pcNumber: 'PC-05' },
                            { name: 'Zeynep Arslan', year: 3, pcNumber: 'PC-06' },
                            { name: 'Mustafa Şahin', year: 4, pcNumber: 'PC-07' },
                            { name: 'Elif Yıldız', year: 4, pcNumber: 'PC-08' }
                        ]
                    },
                    'lab2': {
                        name: 'Lab 2 - Yazılım Laboratuvarı',
                        students: [
                            { name: 'Can Özdemir', year: 1, pcNumber: 'PC-01' },
                            { name: 'Selin Kara', year: 2, pcNumber: 'PC-02' },
                            { name: 'Burak Yılmaz', year: 2, pcNumber: 'PC-03' },
                            { name: 'Deniz Kılıç', year: 3, pcNumber: 'PC-04' },
                            { name: 'Gizem Ak', year: 4, pcNumber: 'PC-05' }
                        ]
                    },
                    'lab3': {
                        name: 'Lab 3 - Ağ Laboratuvarı',
                        students: [
                            { name: 'Emre Doğan', year: 1, pcNumber: 'PC-01' },
                            { name: 'Seda Yılmaz', year: 1, pcNumber: 'PC-02' },
                            { name: 'Oğuz Çelik', year: 2, pcNumber: 'PC-03' },
                            { name: 'Pınar Özkan', year: 3, pcNumber: 'PC-04' },
                            { name: 'Tolga Şen', year: 3, pcNumber: 'PC-05' },
                            { name: 'Merve Aydın', year: 4, pcNumber: 'PC-06' }
                        ]
                    }
                };
                
                return sampleData[labId] || { name: 'Bilinmeyen Lab', students: [] };
            }

            // PC kartlarını oluştur
            function createPCCards(labData) {
                const pcCardsGrid = document.getElementById('pcCardsGrid');
                pcCardsGrid.innerHTML = '';

                // PC sayısını hesapla (örnek: 8 PC)
                const totalPCs = 8;
                const students = labData.students || [];
                
                // Öğrencileri PC'lere dağıt
                const pcAssignments = {};
                students.forEach((student, index) => {
                    const pcNumber = `PC-${String(index + 1).padStart(2, '0')}`;
                    if (!pcAssignments[pcNumber]) {
                        pcAssignments[pcNumber] = [];
                    }
                    pcAssignments[pcNumber].push(student);
                });

                // PC kartlarını oluştur
                for (let i = 1; i <= totalPCs; i++) {
                    const pcNumber = `PC-${String(i).padStart(2, '0')}`;
                    const assignedStudents = pcAssignments[pcNumber] || [];
                    const isOccupied = assignedStudents.length > 0;
                    
                    const pcCard = document.createElement('div');
                    pcCard.className = `pc-card ${isOccupied ? 'occupied' : 'available'} fade-in`;
                    pcCard.innerHTML = `
                        <div class="pc-card-header">
                            <div class="pc-number">${pcNumber}</div>
                            <div class="pc-status">
                                <i class="fas ${isOccupied ? 'fa-times-circle' : 'fa-check-circle'}"></i>
                                ${isOccupied ? 'Dolu' : 'Boş'}
                                ${isOccupied ? `<span class="student-count-badge">${assignedStudents.length}</span>` : ''}
                            </div>
                        </div>
                        <div class="pc-card-body">
                            ${isOccupied ? `
                                <div class="students-list">
                                    ${assignedStudents.map(student => `
                                        <div class="student-item">
                                            <div class="student-name clickable-student">${student.name}</div>
                                            <div class="student-year">${student.year}. Sınıf</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : `
                                <div class="empty-pc">
                                    <i class="fas fa-desktop"></i>
                                    <span>Boş PC</span>
                                </div>
                            `}
                        </div>
                        <div class="pc-card-actions">
                            <button class="action-btn view-btn" title="Görüntüle">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn assign-btn" title="Atama Yap">
                                <i class="fas fa-user-plus"></i>
                            </button>
                        </div>
                    `;
                    
                    pcCardsGrid.appendChild(pcCard);
                }

                // İstatistikleri güncelle
                updateStats(students, totalPCs);
                
                // PC kartları güncellendi eventi gönder
                const event = new CustomEvent('pcCardsUpdated');
                document.dispatchEvent(event);
            }

            // İstatistikleri güncelle
            function updateStats(students, totalPCs) {
                const occupiedPCs = Object.keys(pcAssignments).length;
                const availablePCs = totalPCs - occupiedPCs;
                
                document.getElementById('totalStudentsCount').textContent = students.length;
                document.getElementById('totalPCCount').textContent = totalPCs;
                document.getElementById('availablePCCount').textContent = availablePCs;
                document.getElementById('availableCount').textContent = availablePCs;
                document.getElementById('occupiedCount').textContent = occupiedPCs;
            }

            // Öğrenci tıklama eventi
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('clickable-student')) {
                    const studentName = e.target.textContent;
                    alert(`Öğrenci: ${studentName}\nTıklama işlemi gerçekleştirildi.`);
                }
            });

            // Excel import butonu
            document.getElementById('excelImportBtn').addEventListener('click', function() {
                alert('Excel import özelliği burada implement edilecek.');
            });

            // Logout butonu
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('Çıkış yapmak istediğinizden emin misiniz?')) {
                    alert('Çıkış yapılıyor...');
                }
            });

            // Refresh butonu
            document.getElementById('refreshBtn').addEventListener('click', function() {
                const selectedLab = document.getElementById('labSelect').value;
                if (selectedLab) {
                    const labData = getLabData(selectedLab);
                    createPCCards(labData);
                }
            });
        });
    </script>
</body>
</html>
